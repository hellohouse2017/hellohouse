<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å³æ™‚æˆ¿æ³æŸ¥è©¢ | ä½ å¥½å“‡å¯“æ‰€ & æºé ‚æ°‘å®¿</title>
    <meta name="description" content="é«˜é›„åŒ…æ£Ÿæ°‘å®¿å³æ™‚æˆ¿æ³æŸ¥è©¢ç³»çµ±ã€‚è¼¸å…¥æ—¥æœŸèˆ‡äººæ•¸ï¼Œç«‹å³è©¦ç®—å„ªæƒ æˆ¿åƒ¹ã€‚">
    <meta name="robots" content="index, follow">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" type="text/css" href="https://npmcdn.com/flatpickr/dist/themes/airbnb.css">

    <style>
        /* =========================================
           Design System
           ========================================= */
        :root {
            --c-primary: #1A202C;       
            --c-accent: #C5A065;        
            --c-accent-hover: #A68550;
            --c-bg-body: #F9F9F7;       
            --c-bg-white: #FFFFFF;
            --c-text-gray: #555555; 
            --c-line: #06C755;
            --c-error: #e53e3e;
            --c-success: #38a169;
            --theme-dark-bg: #1A202C;
            --font-serif: 'Noto Serif TC', serif; 
            --font-sans: 'Noto Sans TC', sans-serif; 
            --shadow-card: 0 10px 40px -10px rgba(0, 0, 0, 0.08);
            --radius-md: 12px;
        }

        *, *::before, *::after { box-sizing: border-box; }
        body { margin: 0; font-family: var(--font-sans); background-color: var(--c-bg-body); color: var(--c-primary); line-height: 1.6; display: flex; flex-direction: column; min-height: 100vh; }
        a { text-decoration: none; color: inherit; transition: 0.3s; }
        ul { list-style: none; padding: 0; margin: 0; }
        
        /* Navbar */
        .navbar { background: rgba(26, 32, 44, 0.95); backdrop-filter: blur(10px); height: 70px; width: 100%; position: fixed; top: 0; left: 0; z-index: 9999; border-bottom: 1px solid rgba(197, 160, 101, 0.3); }
        .nav-container { display: flex; justify-content: space-between; align-items: center; height: 100%; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .nav-logo { color: var(--c-accent); font-family: var(--font-serif); font-size: 1.5rem; font-weight: 700; letter-spacing: 1px; }
        .nav-menu { display: flex; align-items: center; gap: 20px; margin: 0; padding: 0; list-style: none; }
        .nav-link { color: #fff; font-size: 0.95rem; font-weight: 500; padding: 10px 5px; position: relative; display: flex; align-items: center; gap: 6px; }
        .nav-link:hover, .nav-link.active { color: var(--c-accent); }
        .nav-link.nav-btn-booking { background-color: var(--c-accent); color: white !important; padding: 8px 20px; border-radius: 50px; font-weight: bold; }
        
        /* Mobile Menu */
        .menu-toggle { display: none; cursor: pointer; }
        .bar { display: block; width: 25px; height: 3px; margin: 5px auto; background-color: var(--c-accent); transition: 0.3s; }
        .dropdown-menu { display:none; position:absolute; background:#fff; width:200px; padding:10px 0; border-radius:8px; top:100%; left:50%; transform:translateX(-50%); box-shadow:0 10px 30px rgba(0,0,0,0.15); }
        .dropdown:hover .dropdown-menu { display:block; }
        .dropdown-link { display:block; padding:10px 20px; color:var(--c-primary); }
        .dropdown-link:hover { background:#f0f0f0; color:var(--c-accent); }

        @media (max-width: 960px) {
            .menu-toggle { display: block; }
            .nav-menu { position: fixed; left: -100%; top: 70px; flex-direction: column; background-color: #1A202C; width: 100%; height: calc(100vh - 70px); padding-top: 20px; transition: 0.3s; }
            .nav-menu.active { left: 0; }
            .nav-link { color: white !important; font-size: 1.1rem; padding: 15px; width: 100%; display: block; }
            .dropdown-menu { position: static; width: 100%; background: #0d1117; transform: none; display:none; }
            .dropdown.active .dropdown-menu { display:block; }
            .arrow-icon { float: right; margin-right: 20px; cursor: pointer; padding: 10px; }
        }

        /* Hero & Content */
        .hero { position: relative; height: 40vh; min-height: 350px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; color: white; background-color: var(--c-primary); margin-top: 70px; }
        .hero-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('images/cover.jpg'); background-size: cover; background-position: center; opacity: 0.5; z-index: 1; }
        .hero-content { position: relative; z-index: 2; }
        .hero h1 { font-family: var(--font-serif); font-size: 2.5rem; margin-bottom: 0.5rem; font-weight: 700; }

        .container { width: 90%; max-width: 1000px; margin: 0 auto; }
        .inquiry-box { background: #fff; border-radius: var(--radius-md); padding: 40px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); margin: -60px auto 0; position: relative; z-index: 10; border: 1px solid #eee; }
        
        /* Guest Buttons */
        .guest-selector { display: flex; gap: 10px; width: 100%; margin-bottom: 5px; }
        .guest-btn { flex: 1; padding: 12px 5px; background: #fff; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; color: #555; font-size: 1rem; font-weight: 500; transition: 0.2s; display: flex; flex-direction: column; align-items: center; justify-content: center; line-height: 1.2; text-align: center; }
        .guest-btn:hover { background: #f5f5f5; }
        .guest-btn.active { background-color: var(--c-accent); color: white; border-color: var(--c-accent); box-shadow: 0 4px 10px rgba(197, 160, 101, 0.3); }
        .guest-btn small { font-size: 0.75rem; font-weight: normal; opacity: 0.9; margin-top: 3px; }

        .form-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .form-group label { display: block; font-size: 0.9rem; color: var(--c-text-gray); margin-bottom: 8px; font-weight: bold; }
        .form-control { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; background: #F8F9FA; transition: 0.3s; }
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 12px 30px; border-radius: 50px; font-weight: 500; cursor: pointer; border: none; font-size: 1rem; width: 100%; transition: 0.3s; }
        .btn-line { background-color: var(--c-line); color: white; }
        .btn-line:hover { background-color: #05b64d; transform: translateY(-2px); }

        /* Steps */
        .step-section { margin-top: 30px; border-top: 2px dashed #eee; padding-top: 30px; display: none; animation: fadeIn 0.5s ease; }
        .step-section.active { display: block; }
        .step-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 5px; color: var(--c-primary); border-left: 4px solid var(--c-accent); padding-left: 10px; }
        .step-subtitle { font-size: 0.95rem; color: #666; margin-bottom: 20px; padding-left: 15px; font-weight: bold; color: var(--c-accent); }

        /* Plans */
        .plan-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
        .plan-card { border: 2px solid #eee; border-radius: 10px; padding: 20px; cursor: pointer; transition: 0.2s; position: relative; background: #fff; }
        .plan-card:hover { border-color: #ddd; background: #fcfcfc; transform: translateY(-2px); }
        .plan-card.selected { border-color: var(--c-accent); background-color: #FFFbf0; box-shadow: 0 4px 12px rgba(197, 160, 101, 0.15); }
        .plan-card h4 { margin: 0 0 5px 0; font-size: 1.1rem; color: var(--c-primary); }
        .plan-price { font-size: 1.1rem; color: var(--c-accent); font-weight: bold; margin-bottom: 8px; font-family: var(--font-sans); }
        .plan-price.event-price { color: #e53e3e; } 
        .plan-desc { font-size: 0.85rem; color: #666; margin: 0; line-height: 1.5; border-top: 1px solid #eee; padding-top: 8px; margin-top: 8px; }
        .plan-capacity { position: absolute; top: 15px; right: 15px; background: #eee; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; color: #555; }
        .plan-card.selected .plan-capacity { background: var(--c-accent); color: white; }
        
        /* Venue Results */
        .venue-results { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; display: none; }
        .venue-card { border: 2px solid #eee; border-radius: 12px; padding: 20px; text-align: center; cursor: pointer; transition: 0.3s; position: relative; background: #fff; display: flex; flex-direction: column; justify-content: space-between; }
        .venue-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .venue-card.disabled { opacity: 0.7; cursor: not-allowed; background: #f9f9f9; border-color: #ddd; }
        .venue-card.available { border-color: var(--c-success); background: #f0fff4; }
        .venue-card.available:hover { background: #e6fffa; }
        .venue-name { font-size: 1.2rem; font-weight: bold; color: var(--c-primary); margin-bottom: 5px; }
        .venue-status { font-size: 1rem; font-weight: bold; margin: 10px 0; }
        .status-ok { color: var(--c-success); } 
        .status-full { color: var(--c-error); }
        .venue-btn { display: inline-block; font-size: 0.9rem; padding: 8px 15px; border-radius: 50px; border: 1px solid; margin-top: 5px; font-weight: bold; }
        .btn-select { background: var(--c-success); color: white; border-color: var(--c-success); }
        .btn-full { background: transparent; color: var(--c-error); border-color: var(--c-error); }
        .btn-external { display: block; width: 100%; text-align: center; padding: 6px 10px; margin-top: auto; margin-bottom: 8px; border: 1px solid #28a745; color: #28a745; border-radius: 8px; font-size: 0.85rem; background: #fff; transition: 0.2s; font-weight: bold; }
        .btn-external:hover { background: #e6fffa; }

        /* Loading & Recs */
        .status-loading { margin-top:30px; padding:20px; background:#EBF8FF; color:#2B6CB0; text-align:center; border-radius:12px; display:none; }
        .recommendation-area { margin-top: 20px; border-top: 1px solid #f0f0f0; padding-top: 15px; text-align: left; display: none; }
        .rec-title { color: #d9534f; font-weight: bold; margin-bottom: 10px; font-size: 0.95rem; }
        .suggestion-item { display: flex; justify-content: space-between; align-items: center; background: #fff; border: 1px solid #e2e2e2; padding: 12px 15px; margin-bottom: 8px; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .suggestion-item:hover { border-color: var(--c-accent); background-color: #fffbf0; }
        
        .sugg-info-block { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; }
        .tag-hot { background: #ffeeba; color: #856404; font-size:0.75rem; padding:3px 8px; border-radius:4px; }
        .tag-week { background: #d1ecf1; color: #0c5460; font-size:0.75rem; padding:3px 8px; border-radius:4px; }
        .tag-part { background: #f8d7da; color: #721c24; font-size:0.75rem; padding:3px 8px; border-radius:4px; }
        .sugg-detail-text { font-size: 0.8rem; color: #666; font-weight: normal; margin-left: 5px; }

        /* Contact Form */
        .contact-form { max-width: 600px; margin: 0 auto; background: #f9f9f9; padding: 30px; border-radius: 12px; border: 1px solid #eee; }
        .input-error { border-color: #e53e3e !important; background-color: #fff5f5 !important; }
        .error-msg { color: #e53e3e; font-size: 0.8rem; display: none; margin-top: 5px; }

        /* Calendar */
        .calendar-toggle-btn { display: block; margin: 40px auto 20px; background: transparent; border: 1px solid #ddd; padding: 10px 20px; border-radius: 50px; cursor: pointer; color: #666; font-size: 0.9rem; }
        .calendars-area { display: none; grid-template-columns: 1fr; gap: 30px; }
        .calendars-area.show { display: grid; animation: fadeIn 0.5s ease; }
        .calendar-card { background: #fff; padding: 20px; border-radius: var(--radius-md); box-shadow: var(--shadow-card); border-top: 4px solid var(--c-accent); }
        .calendar-container { position: relative; padding-bottom: 75%; height: 0; overflow: hidden; border-radius: 8px; background: #f9f9f9; }
        .calendar-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

        /* Footer */
        .footer { background-color: var(--theme-dark-bg); color: #aaa; padding: 80px 0 40px; border-top: 3px solid var(--c-accent); width: 100%; margin-top: auto; }
        .footer-grid { display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 50px; max-width: 1100px; margin: 0 auto; padding: 0 20px; }
        .footer h3 { color: white; font-size: 1.1rem; margin-bottom: 25px; font-family: var(--font-serif); }
        .contact-row { margin-bottom: 15px; display: flex; align-items: flex-start; gap: 12px; }
        .copyright { text-align: center; padding-top: 30px; border-top: 1px solid #222; font-size: 0.85rem; }
        .sticky-btn { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background-color: var(--c-line); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 30px; box-shadow: 0 5px 20px rgba(6,199,85,0.4); z-index: 999; }
        
        .fade-in { opacity: 0; transform: translateY(20px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .fade-in.visible { opacity: 1; transform: translateY(0); }

        @media (max-width: 960px) {
            .venue-results { grid-template-columns: 1fr; }
            .inquiry-box { margin-top: -40px; padding: 30px 20px; width: 95%; }
            .calendars-area { grid-template-columns: 1fr; }
            .guest-selector { flex-direction: column; }
            .footer-grid { grid-template-columns: 1fr; gap: 40px; }
            .sugg-info-block { flex-direction: column; align-items: flex-start; gap: 2px; }
            .sugg-detail-text { margin-left: 0; }
        }

        /* ====== ä¿®æ­£ä¸‹æ‹‰é¸å–®å°é½Šå•é¡Œ (Fix Dropdown Alignment) ====== */
        
        /* 1. å¼·åˆ¶è®“æ¯å€‹å°è¦½é¸é … (li) æˆç‚ºå®šä½åŸºæº–é» */
        .nav-item {
            position: relative !important;
        }

        /* 2. ä¿®æ­£ä¸‹æ‹‰é¸å–®çš„ä½ç½®è¨ˆç®— */
        .dropdown-menu {
            left: 50% !important; /* ä»¥çˆ¶æŒ‰éˆ•çš„ä¸­å¿ƒé»ç‚ºåŸºæº– */
            transform: translateX(-50%) translateY(10px) !important; /* å¾€å›ä¿®æ­£ 50% å¯¬åº¦ä»¥é”åˆ°æ­£å±…ä¸­ */
            top: 100% !important; /* è²¼é½ŠæŒ‰éˆ•åº•éƒ¨ */
            text-align: left; /* é¸å–®å…§çš„æ–‡å­—é å·¦ */
            min-width: 180px; /* ç¢ºä¿é¸å–®ä¸æœƒå¤ªçª„ */
        }

        /* 3. ç¢ºä¿ç®­é ­èˆ‡æ–‡å­—ä¸æ›è¡Œï¼Œé¿å…å¯¬åº¦è¨ˆç®—è·‘æ‰ */
        .nav-link {
            white-space: nowrap; 
        }
        
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">ä½ å¥½å“‡å¯“æ‰€</a>
            <div class="menu-toggle" id="mobile-menu">
                <span class="bar"></span><span class="bar"></span><span class="bar"></span>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <span><i class="fa-solid fa-house"></i> é¦–é </span>
                    </a>
                </li>

                <li class="nav-item">
                    <a href="rooms.html" class="nav-link">
                        <span><i class="fa-solid fa-bed"></i> æˆ¿å‹ä»‹ç´¹</span>
                    </a>
                </li>
                
                <li class="nav-item dropdown">
                    <a href="agreement.html" class="nav-link dropdown-toggle">
                        <span><i class="fa-solid fa-file-signature"></i> å…¥ä½å¥‘ç´„</span>
                        <i class="fa-solid fa-angle-down arrow-icon"></i> </a>
                    <ul class="dropdown-menu">
                        <li><a href="signature.html" class="dropdown-link"><i class="fa-solid fa-pen-nib"></i> ç·šä¸Šç°½ç´„/æ¢æ¬¾</a></li>
                    </ul>
                </li>

                <li class="nav-item">
                    <a href="traffic.html" class="nav-link">
                        <span><i class="fa-solid fa-car"></i> äº¤é€šåœè»Š</span>
                    </a>
                </li>
                
                <li class="nav-item dropdown">
                    <a href="travel.html" class="nav-link active dropdown-toggle">
                        <span><i class="fa-solid fa-map-location-dot"></i> æ—…éŠè¡Œç¨‹</span>
                        <i class="fa-solid fa-angle-down arrow-icon"></i> </a>
                    <ul class="dropdown-menu">
                        <li><a href="attractions.html" class="dropdown-link"><i class="fa-solid fa-location-arrow"></i> å‘¨é‚Šæ™¯é»</a></li>
                        <li><a href="food.html" class="dropdown-link"><i class="fa-solid fa-utensils"></i> ç¾é£Ÿåœ°åœ–</a></li>
                    </ul>
                </li>
                
                <li class="nav-item dropdown">
                    <a href="packages.html" class="nav-link dropdown-toggle" style="color:var(--c-accent);">
                        <span><i class="fa-solid fa-bullhorn"></i> ä½å®¿æƒ…å ±</span>
                        <i class="fa-solid fa-angle-down arrow-icon"></i> </a>
                    <ul class="dropdown-menu">
                        <li><a href="packages-business.html" class="dropdown-link"><i class="fa-solid fa-building"></i> ä¼æ¥­åŒ…æ£Ÿ</a></li>
                        <li><a href="packages-wedding.html" class="dropdown-link"><i class="fa-solid fa-heart"></i> è¿å¨¶åŒ…æ£Ÿ</a></li>
                        <li><a href="packages-family.html" class="dropdown-link"><i class="fa-solid fa-users"></i> å®¶æ—åŒ…æ£Ÿ</a></li>
                        <li><a href="packages-team.html" class="dropdown-link"><i class="fa-solid fa-basketball"></i> çƒéšŠæ¯”è³½</a></li>
                    </ul>
                </li>

                <li class="nav-item">
                    <a href="check.html" class="nav-link nav-btn-booking" style="justify-content: center;">
                        <span><i class="fa-solid fa-calendar-check"></i> æŸ¥è©¢ç©ºæˆ¿</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <a href="javascript:void(0)" onclick="sendToLine()" class="sticky-btn" aria-label="Line è¨‚æˆ¿">
        <i class="fa-brands fa-line"></i>
    </a>

    <header class="hero">
        <div class="hero-bg"></div>
        <div class="hero-content fade-in">
            <h1>æ™ºæ…§æˆ¿æ³æŸ¥è©¢</h1>
            <p>å³æ™‚ç³»çµ±é€£ç·šãƒ»è‡ªå‹•è¨ˆç®—å„ªæƒ æˆ¿åƒ¹</p>
        </div>
    </header>

    <div class="container">
        <div class="inquiry-box fade-in">
            
            <div id="step-1-query">
                <h2 style="font-size:1.4rem; margin-bottom:20px;"><i class="fa-solid fa-calendar-days" style="color:var(--c-accent)"></i> 1. æŸ¥è©¢æª”æœŸ</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>1. é è¨ˆäººæ•¸ (è«‹é¸æ“‡å€é–“)</label>
                        <div class="guest-selector">
                            <div class="guest-btn active" onclick="selectGuestRange('range1', this)">
                                12äººå…§
                                <small>ä½ å¥½å“‡ / æºé ‚</small>
                            </div>
                            <div class="guest-btn" onclick="selectGuestRange('range2', this)">
                                13-26äºº
                                <small>ä½ å¥½å“‡å¯“æ‰€</small>
                            </div>
                            <div class="guest-btn" onclick="selectGuestRange('range3', this)">
                                26-38äºº
                                <small>ä½ å¥½å“‡+æºé ‚æ°‘å®¿ é›™åŒ…æ£Ÿ</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>2. å…¥ä½ - é€€æˆ¿æ—¥æœŸ</label>
                        <input type="text" id="date-range" class="form-control" placeholder="é¸æ“‡æ—¥æœŸ">
                    </div>
                    
                    <button class="btn btn-line" onclick="startQuery()">
                        <i class="fa-solid fa-magnifying-glass"></i> æŸ¥è©¢ç©ºæˆ¿
                    </button>
                </div>
                
                <div id="loading-box" class="status-loading">
                    <i class="fa-solid fa-spinner fa-spin"></i> æ­£åœ¨é€£ç·šç¢ºèªå³æ™‚æª”æœŸ...
                </div>

                <div id="venue-results" class="venue-results"></div>

                <div id="recommendation-area" class="recommendation-area"></div>
            </div>

            <div id="step-2-plan" class="step-section">
                <div class="step-title">2. è«‹é¸æ“‡æ‚¨çš„åŒ…æ£Ÿæˆ¿å‹é…ç½® (é»æ“Šé¸æ“‡)</div>
                <div id="step-2-subtitle" class="step-subtitle"></div>
                <div id="plan-container" class="plan-options"></div>
                <p style="text-align:right; font-size:0.8rem; color:#888; margin-top:10px;">* åƒ¹æ ¼åƒ…ä¾›åƒè€ƒï¼Œå¯¦éš›ä»¥ç®¡å®¶å ±åƒ¹ç‚ºæº–ã€‚</p>
            </div>

            <div id="step-3-contact" class="step-section">
                <div class="step-title">3. å¡«å¯«è¯çµ¡è³‡æ–™ï¼Œå³åˆ»å–å¾—å„ªæƒ ï¼</div>
                <div class="contact-form">
                    <div class="form-group" style="margin-bottom:15px;">
                        <label>è¯çµ¡äººå§“å</label>
                        <input type="text" id="user-name" class="form-control" placeholder="è«‹è¼¸å…¥æ‚¨çš„ç¨±å‘¼">
                    </div>
                    <div class="form-group" style="margin-bottom:20px;">
                        <label>æ‰‹æ©Ÿè™Ÿç¢¼</label>
                        <input type="tel" id="user-phone" class="form-control" placeholder="09xxxxxxxx" maxlength="10">
                        <div id="phone-error" class="error-msg">è«‹è¼¸å…¥æ­£ç¢ºçš„ 10 ç¢¼æ‰‹æ©Ÿè™Ÿç¢¼ (09é–‹é ­)</div>
                    </div>
                    
                    <button id="btn-submit" class="btn btn-line" style="width:100%; padding:15px; font-size:1.1rem;" onclick="sendToLine()">
                        <i class="fa-brands fa-line"></i> æ‰¾ç®¡å®¶è©¢å•å„ªæƒ åƒ¹
                    </button>
                    
                    <div id="manual-line-btn" style="display:none; margin-top:15px; text-align:center;">
                        <a id="force-line-link" href="#" class="btn" style="background:#06C755; color:white;">
                            <i class="fa-brands fa-line"></i> é–‹å•Ÿ LINE
                        </a>
                    </div>
                    <p style="text-align:center; font-size:0.8rem; color:#888; margin-top:15px;">ğŸ’¡ ç³»çµ±å·²è‡ªå‹•è¤‡è£½è¨‚æˆ¿è³‡è¨Šï¼Œé–‹å•Ÿ LINE å¾Œè«‹åœ¨å°è©±æ¡†ã€Œé•·æŒ‰è²¼ä¸Šã€å³å¯ã€‚</p>
                </div>
            </div>

        </div>

        <button class="calendar-toggle-btn" onclick="toggleCalendarVisibility()">
            <i class="fa-solid fa-eye"></i> é¡¯ç¤º/éš±è— è©³ç´°æ—¥æ›†
        </button>

        <div id="calendars-wrapper" class="calendars-area fade-in">
            <div class="calendar-card" id="cal-hello">
                <h3>ä½ å¥½å“‡å¯“æ‰€ <span style="font-size:0.8rem; background:#eee; padding:2px 8px; border-radius:4px; margin-left:10px; color:#555;">ä¸»é¤¨</span></h3>
                <div class="calendar-container"><iframe src="https://calendar.google.com/calendar/embed?src=a77a451f0a645261b0202f6faf810082df31f92d20fe20c19cbb10945d9714f4%40group.calendar.google.com&ctz=Asia%2FTaipei" scrolling="no"></iframe></div>
            </div>
            <div class="calendar-card" id="cal-gouding">
                <h3>æºé ‚æ°‘å®¿ <span style="font-size:0.8rem; background:#795548; padding:2px 8px; border-radius:4px; color:#fff;">äºŒé¤¨</span></h3>
                <div class="calendar-container"><iframe src="https://calendar.google.com/calendar/embed?src=56feb65c62285b41fe4c97af783991d9710832f223bf2a85919bb60c04be3603%40group.calendar.google.com&ctz=Asia%2FTaipei&color=%23795548" scrolling="no"></iframe></div>
            </div>
        </div>
        <div style="height: 100px;"></div>
    </div>

        <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <h3>é—œæ–¼ ä½ å¥½å“‡å¯“æ‰€</h3>
                    <div class="footer-desc">
                        <p>ã€Œä½ å¥½å“‡ãƒ»å¯“æ‰€ã€ä½æ–¼æ“æœ‰æ·±åšæ­·å²åº•è˜Šçš„<strong>é«˜é›„é¹½åŸ•å€</strong>ï¼Œæ˜¯ä¸€é–“ä¿ç•™äº†<strong>è€å±‹æº«åº¦</strong>ä¸”<strong>åˆæ³•</strong>çš„ç²¾ç·»ç¨æ£Ÿæ°‘å®¿ã€‚æˆ‘å€‘æ“æœ‰çµ•ä½³çš„åœ°ç†ä½ç½®ï¼Œé„°è¿‘<strong>æ·é‹é¹½åŸ•åŸ”ç«™</strong>ï¼Œæ­¥è¡Œè‡³<strong>é§äºŒè—è¡“ç‰¹å€</strong>åƒ…éœ€10åˆ†é˜ï¼Œ<strong>å¤§æ¸¯æ©‹</strong>äº¦è¿‘åœ¨å’«å°ºã€‚</p>
                        <p>æˆ‘å€‘å°ˆæ³¨æ–¼æä¾› <strong>6~38äºº</strong> çš„å½ˆæ€§<strong>å¤§ç©ºé–“åŒ…æ£Ÿä½å®¿</strong>ã€‚é¤¨å…§é…ç½®äº†<strong>å¤§å‹ä¸­å³¶å»šæˆ¿</strong>ã€å¯¬æ•èˆ’é©çš„å¤§å®¢å»³èˆ‡å°ˆå±¬<strong>éº»å°‡è¨­å‚™</strong>ã€‚ç„¡è«–æ˜¯æº«é¦¨çš„<strong>å®¶åº­æ—…éŠ</strong>ã€ç†±é¬§çš„<strong>æœ‹å‹èšæœƒ</strong>æˆ–æ˜¯<strong>å“¡å·¥æ—…éŠ</strong>ï¼Œé€™è£¡éƒ½æ˜¯æ‚¨åœ¨é«˜é›„æ¸¯éƒ½çš„æœ€ä½³é¸æ“‡ã€‚</p>
                    </div>
                </div>
                <div>
                    <h3>è¯çµ¡è³‡è¨Š</h3>
                    <div class="contact-row">
                        <i class="fa-solid fa-location-dot"></i>
                        <a href="https://goo.gl/maps/qxGN4mpNP8qfRCB16" target="_blank">é«˜é›„å¸‚é¹½åŸ•å€å¤§å…¬è·¯70å··8è™Ÿ<br>(è¿‘æ·é‹é¹½åŸ•åŸ”ç«™ O2)</a>
                    </div>
                    <div class="contact-row">
                        <i class="fa-solid fa-phone"></i>
                        <a href="tel:0932828922">0932-828-922</a>
                    </div>
                    <div class="contact-row">
                        <i class="fa-brands fa-line"></i>
                        <a href="https://lin.ee/atCiMQw" target="_blank">LINE ID: @575tprig</a>
                    </div>
                </div>
                <div>
                    <h3>ç†±é–€é—œéµå­—</h3>
                    <div class="seo-tags">
                        <span>é«˜é›„åŒ…æ£Ÿæ¨è–¦</span><span>é¹½åŸ•å€æ°‘å®¿</span><span>é§äºŒä½å®¿</span>
                        <span>éº»å°‡æ°‘å®¿</span><span>ä¸­å³¶å»šæˆ¿</span><span>è¦ªå­ä½å®¿</span><span>æ£§è²³åº«å‘¨é‚Š</span>
                        <span>KTVæ°‘å®¿</span><span>åˆæ³•æ°‘å®¿</span><span>å“¡å·¥æ—…éŠ</span>
                    </div>
                </div>
            </div>
            <div class="copyright">
                Â© 2025 ä½ å¥½å“‡å¯“æ‰€ Hello House. All Rights Reserved.
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/zh-tw.js"></script>
    
    <script>
        const GAS_APP_URL = "https://script.google.com/macros/s/AKfycbxsFEJ9ubWMY9Y6xqBZ-3-KgSrYQnC9D3zwuKUL66HvKJdN5S1HTNeahhWlV6hcixbx0A/exec";
        const LINE_DEEP_LINK = "line://ti/p/@575tprig"; 

        let selectedStart = null;
        let selectedEnd = null;
        let selectedGuestRange = 'range1'; 
        let currentSelectedPlan = null;
        let currentEstimatedPrice = null;
        let currentVenueName = null;
        
        const WEEKDAYS = ["é€±æ—¥", "é€±ä¸€", "é€±äºŒ", "é€±ä¸‰", "é€±å››", "é€±äº”", "é€±å…­"];
        function getWeekday(dateStr) {
            const d = new Date(dateStr);
            return WEEKDAYS[d.getDay()];
        }

        const SPECIAL_EVENTS = [
            "2025-03-29", "2025-03-30", 
            "2025-04-04", "2025-04-05", 
            "2025-12-31"
        ];

        const NATIONAL_HOLIDAYS = ["2025-01-01", "2025-01-25", "2025-01-26", "2025-01-27", "2025-01-28", "2025-01-29", "2025-01-30", "2025-01-31", "2025-02-01", "2025-02-02", "2025-02-28", "2025-03-01", "2025-03-02", "2025-04-03", "2025-04-04", "2025-04-05", "2025-04-06", "2025-05-30", "2025-05-31", "2025-06-01", "2025-10-04", "2025-10-05", "2025-10-06", "2025-10-10", "2025-10-11", "2025-10-12"];

        const ROOM_PLANS = {
            'hello': [
                { title: "3æˆ¿åŒ…æ£Ÿ (8äºº)", price_weekday: 16000, price_weekend: 20000, capacity: "8äºº", detail: "é…ç½®ï¼š3æˆ¿ (2/2/4)" },
                { title: "4æˆ¿åŒ…æ£Ÿ (14äºº)", price_weekday: 20000, price_weekend: 24000, capacity: "14äºº", detail: "é…ç½®ï¼š4æˆ¿ (2/2/4/6)" },
                { title: "5æˆ¿åŒ…æ£Ÿ (16äºº)", price_weekday: 22000, price_weekend: 26000, capacity: "16äºº", detail: "é…ç½®ï¼š5æˆ¿ (2/2/2/4/6)" },
                { title: "5+1æˆ¿åŒ…æ£Ÿ (22äºº)", price_weekday: 26000, price_weekend: 30000, capacity: "22äºº", detail: "é…ç½®ï¼š5+1æˆ¿ (2/2/2/4/6/6)" },
                { title: "5+1æˆ¿+åŠ åºŠ (26äºº)", price_weekday: 30000, price_weekend: 36000, capacity: "26äºº", detail: "é…ç½®ï¼š2/2/2/4/6+2/6+2 (å…¨é–‹)" }
            ],
            'gouding': [
                { title: "3æˆ¿åŒ…æ£Ÿ (10äºº)", price_weekday: 10000, price_weekend: 14000, capacity: "10äºº", detail: "é…ç½®ï¼š3æˆ¿ (2/4/4)" },
                { title: "4æˆ¿åŒ…æ£Ÿ (12äºº)", price_weekday: 12000, price_weekend: 16000, capacity: "12äºº", detail: "é…ç½®ï¼š4æˆ¿ (2/4/4/2)" }
            ],
            'double': [
                { title: "ä½ å¥½å“‡+æºé ‚æ°‘å®¿ é›™åŒ…æ£Ÿ (27-38äºº)", price_weekday: 42000, price_weekend: 50000, capacity: "27-38äºº", detail: "åŒ…å«ï¼šä½ å¥½å“‡(26äºº) + æºé ‚(12äºº)" }
            ]
        };

        const fp = flatpickr("#date-range", {
            mode: "range", locale: "zh_tw", dateFormat: "Y-m-d", minDate: "today",
            onOpen: function() { resetSteps(); },
            onChange: function(dates) { resetSteps(); },
            onClose: function(dates) { 
                if (dates.length === 2) { 
                    selectedStart = dates[0]; 
                    selectedEnd = dates[1]; 
                } 
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
            }, { threshold: 0.1 });
            document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

            const mobileMenu = document.getElementById('mobile-menu');
            const navMenu = document.querySelector('.nav-menu');
            const allDropdowns = document.querySelectorAll('.dropdown');

            mobileMenu.addEventListener('click', () => {
                mobileMenu.classList.toggle('is-active');
                navMenu.classList.toggle('active');
            });

            allDropdowns.forEach(dropdown => {
                const link = dropdown.querySelector('.dropdown-toggle');
                const arrow = link.querySelector('.arrow-icon');
                if(link && arrow) {
                    arrow.addEventListener('click', (e) => {
                        if (window.innerWidth <= 960) {
                            e.preventDefault(); e.stopPropagation(); 
                            const isAlreadyOpen = dropdown.classList.contains('active');
                            allDropdowns.forEach(d => d.classList.remove('active'));
                            if (!isAlreadyOpen) dropdown.classList.add('active');
                        }
                    });
                }
            });
            document.addEventListener('click', (e) => {
                if (!navMenu.contains(e.target) && !mobileMenu.contains(e.target)) {
                    navMenu.classList.remove('active');
                    mobileMenu.classList.remove('is-active');
                }
            });
        });

        function selectGuestRange(range, btn) {
            selectedGuestRange = range;
            document.querySelectorAll('.guest-btn').forEach(el => el.classList.remove('active'));
            btn.classList.add('active');
            resetSteps();
        }

        function startQuery() {
            resetSteps();
            if (!selectedStart || !selectedEnd) { alert("è«‹å…ˆé¸æ“‡å…¥ä½èˆ‡é€€æˆ¿æ—¥æœŸ"); fp.open(); return; }
            document.getElementById('loading-box').style.display = 'block';
            const startStr = formatDate(selectedStart);
            const endStr = formatDate(selectedEnd);
            const url = `${GAS_APP_URL}?start=${startStr}&end=${endStr}&venue=all`;

            fetch(url).then(r => r.json()).then(data => {
                document.getElementById('loading-box').style.display = 'none';
                renderVenueCards(data.status);
                let needRec = false;
                if (selectedGuestRange === 'range1' && !data.status.hello.available && !data.status.gouding.available) needRec = true;
                if (selectedGuestRange === 'range2' && !data.status.hello.available) needRec = true;
                if (selectedGuestRange === 'range3' && (!data.status.hello.available || !data.status.gouding.available)) needRec = true;
                if (needRec) renderRecommendations(data.suggestions);
            }).catch(e => {
                console.error(e);
                document.getElementById('loading-box').style.display = 'none';
                alert("é€£ç·šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦");
            });
        }

        function renderVenueCards(status) {
            const container = document.getElementById('venue-results');
            container.innerHTML = '';
            container.style.display = 'grid';
            let cardsToShow = [];

            if (selectedGuestRange === 'range3') {
                const isDoubleAvailable = status.hello.available && status.gouding.available;
                cardsToShow.push({ key: 'double', name: 'ä½ å¥½å“‡+æºé ‚æ°‘å®¿ é›™åŒ…æ£Ÿ', available: isDoubleAvailable, desc: 'é©åˆ 27-38 äººå¤§åœ˜é«”' });
            } else if (selectedGuestRange === 'range2') {
                cardsToShow.push({ key: 'hello', name: 'ä½ å¥½å“‡å¯“æ‰€ (ä¸»é¤¨)', available: status.hello.available, desc: 'é©åˆ 13-26 äºº' });
            } else {
                cardsToShow.push({ key: 'hello', name: 'ä½ å¥½å“‡å¯“æ‰€ (ä¸»é¤¨)', available: status.hello.available, desc: 'é©åˆ 6-26 äºº' });
                cardsToShow.push({ key: 'gouding', name: 'æºé ‚æ°‘å®¿ (äºŒé¤¨)', available: status.gouding.available, desc: 'é©åˆ 6-12 äºº' });
            }

            cardsToShow.forEach(card => {
                const div = document.createElement('div');
                const statusClass = card.available ? 'available' : 'disabled';
                const statusText = card.available ? '<span class="status-ok"><i class="fa-solid fa-circle-check"></i> å¯é è¨‚</span>' : '<span class="status-full">âŒ å·²æ»¿æˆ¿</span>';
                const btnClass = card.available ? 'btn-select' : 'btn-full';
                const btnText = card.available ? 'é¸æ“‡æ­¤é¤¨' : 'ä¸å¯é è¨‚';
                
                let extraBtn = '';
                if (card.key === 'gouding') {
                    extraBtn = `<a href="../godin/index.html" target="_blank" rel="noopener noreferrer" class="btn-external"><i class="fa-solid fa-arrow-up-right-from-square"></i> å‰å¾€æºé ‚æ°‘å®¿ç¶²ç«™</a>`;
                }

                div.className = `venue-card ${statusClass}`;
                div.innerHTML = `
                    <div>
                        <div class="venue-name">${card.name}</div>
                        <div style="font-size:0.85rem; color:#666; margin-bottom:5px;">${card.desc}</div>
                        <div class="venue-status">${statusText}</div>
                    </div>
                    <div>
                        ${extraBtn}
                        <div class="venue-btn ${btnClass}">${btnText}</div>
                    </div>
                `;
                
                if (card.available) {
                    div.onclick = (e) => {
                        if(e.target.closest('.btn-external')) return;
                        selectVenue(card.key, card.name);
                    };
                }
                container.appendChild(div);
            });
        }

        function selectVenue(key, name) {
            currentVenueName = name;
            renderRoomOptions(key);
        }

        function processBestRecommendations(rawSuggestions) {
            if (!rawSuggestions || rawSuggestions.length === 0) return [];
            let best5 = [];
            const partial = rawSuggestions.find(s => s.tag === 'part');
            if (partial) best5.push(partial);
            const days = rawSuggestions.filter(s => s.tag !== 'part' && s.tag !== 'week').slice(0, 2);
            best5 = best5.concat(days);
            const weeks = rawSuggestions.filter(s => s.tag === 'week').slice(0, 2);
            best5 = best5.concat(weeks);
            if (best5.length < 5) {
                const others = rawSuggestions.filter(s => !best5.includes(s));
                best5 = best5.concat(others.slice(0, 5 - best5.length));
            }
            return best5;
        }

        function renderRecommendations(suggestions) {
            const area = document.getElementById('recommendation-area');
            area.innerHTML = '';
            const finalSuggestions = processBestRecommendations(suggestions);
            if (finalSuggestions.length === 0) return;

            area.style.display = 'block';
            let html = `<div class="rec-title"><i class="fa-solid fa-bell"></i> å¾ˆæŠ±æ­‰ï¼Œæ‚¨é¸æ“‡çš„æ—¥æœŸå·²æ»¿ã€‚ç‚ºæ‚¨æ¨è–¦æœ€ä½³æª”æœŸï¼š</div><ul class="suggestion-list">`;
            
            finalSuggestions.forEach(s => {
                let tagClass = 'tag-hot';
                let icon = 'fa-calendar-day';
                let label = s.label || 'æ¨è–¦æª”æœŸ';
                let subLabel = '';

                // Calculate Diff
                const sDate = new Date(s.start);
                const diffTime = sDate - selectedStart;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                // Logic for displaying relative time and weekdays
                if (s.tag === 'part') {
                    tagClass = 'tag-part'; 
                    icon = 'fa-scissors'; 
                    label = 'ç¸®çŸ­å¤©æ•¸';
                } else if (Math.abs(diffDays) >= 7) {
                    // Logic: Week Shift
                    tagClass = 'tag-week';
                    const weeks = Math.round(diffDays / 7);
                    const direction = weeks > 0 ? "å¾€å¾Œ" : "æå‰";
                    label = `${direction} ${Math.abs(weeks)} é€±`;
                    
                    // Logic: Weekday info
                    const startW = getWeekday(s.start);
                    const endW = getWeekday(s.end);
                    subLabel = `(åŒç‚º ${startW} - ${endW})`;

                } else {
                    // Logic: Day Shift
                    const direction = diffDays > 0 ? "å¾€å¾Œ" : "æå‰";
                    label = `${direction} ${Math.abs(diffDays)} å¤©`;
                }
                
                html += `<li class="suggestion-item" onclick="applyDate('${s.start}', '${s.end}')">`;
                html += `<div class="sugg-info-block">`;
                html += `  <div style="display:flex; align-items:center;">`;
                html += `    <span class="sugg-tag ${tagClass}"><i class="fa-solid ${icon}"></i> ${label}</span>`;
                html += `    <span class="sugg-date">${s.start} ~ ${s.end}</span>`;
                html += `  </div>`;
                if(subLabel) {
                    html += `  <span class="sugg-detail-text">${subLabel}</span>`;
                }
                html += `</div>`;
                html += `<span class="sugg-action">é¸æ“‡ <i class="fa-solid fa-angle-right"></i></span></li>`;
            });
            html += `</ul>`;
            area.innerHTML = html;
        }

        function resetSteps() {
            document.getElementById('step-2-plan').classList.remove('active');
            document.getElementById('step-3-contact').classList.remove('active');
            document.getElementById('venue-results').style.display = 'none';
            document.getElementById('recommendation-area').style.display = 'none';
            currentSelectedPlan = null;
        }

        function isWeekendOrHoliday(date) {
            const dateStr = formatDate(date);
            if (NATIONAL_HOLIDAYS.includes(dateStr)) return true;
            const day = date.getDay();
            if (day === 5 || day === 6) return true; // Fri, Sat
            return false;
        }

        function isSpecialEvent(date) {
            return SPECIAL_EVENTS.includes(formatDate(date));
        }

        function calculateTotalPrice(plan, start, end, venueKey) {
            let total = 0;
            let current = new Date(start);
            let endD = new Date(end);
            let weekdayCount = 0;
            let holidayCount = 0;
            let hasSpecialEvent = false;

            let checkDate = new Date(start);
            while (checkDate < endD) {
                if (isSpecialEvent(checkDate)) {
                    hasSpecialEvent = true;
                    break;
                }
                checkDate.setDate(checkDate.getDate() + 1);
            }

            if (hasSpecialEvent) {
                let eventPrice = 0;
                if (venueKey === 'hello') eventPrice = 34800;
                else if (venueKey === 'gouding') eventPrice = 18400;
                else if (venueKey === 'double') eventPrice = 53200; 

                return { 
                    totalPrice: eventPrice.toLocaleString(), 
                    desc: "<span style='color:#e53e3e;font-weight:bold;'>ğŸ”¥ é«˜é›„é‡å¤§æ´»å‹•ãƒ»åŸåƒ¹æª”æœŸ</span>",
                    isEvent: true
                };
            }

            while (current < endD) {
                if (isWeekendOrHoliday(current)) { total += plan.price_weekend; holidayCount++; } 
                else { total += plan.price_weekday; weekdayCount++; }
                current.setDate(current.getDate() + 1);
            }
            
            let descParts = [];
            if (weekdayCount > 0) descParts.push(`${weekdayCount}å¹³æ—¥`);
            if (holidayCount > 0) descParts.push(`${holidayCount}å‡æ—¥`);
            return { totalPrice: total.toLocaleString(), desc: descParts.join('+'), isEvent: false };
        }

        function renderRoomOptions(venueKey) {
            const container = document.getElementById('plan-container');
            container.innerHTML = '';
            const plans = ROOM_PLANS[venueKey] || [];
            const daysDiff = Math.round((selectedEnd - selectedStart)/(1000*60*60*24));
            document.getElementById('step-2-subtitle').innerText = `å·²é¸æ“‡ï¼š${formatDate(selectedStart)} è‡³ ${formatDate(selectedEnd)} (å…± ${daysDiff} æ™š) - ${currentVenueName}`;

            plans.forEach((plan) => {
                const calc = calculateTotalPrice(plan, selectedStart, selectedEnd, venueKey);
                const totalStr = `$${calc.totalPrice}`;
                const detailStr = `(${calc.desc})`;
                const priceClass = calc.isEvent ? 'plan-price event-price' : 'plan-price';

                const div = document.createElement('div');
                div.className = 'plan-card';
                div.innerHTML = `
                    <span class="plan-capacity">${plan.capacity}</span>
                    <h4>${plan.title}</h4>
                    <div class="${priceClass}">é ä¼°ç¸½åƒ¹ ${totalStr} <span style="font-size:0.8rem;font-weight:normal;color:#666;">${detailStr}</span></div>
                    <p class="plan-desc">${plan.detail}</p>
                    <div class="select-hint">é»æ“Šé¸æ“‡æ­¤æ–¹æ¡ˆ</div>
                `;
                div.onclick = () => selectPlan(div, plan.title, totalStr + " " + detailStr);
                container.appendChild(div);
            });
            
            const section = document.getElementById('step-2-plan');
            section.classList.add('active');
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function selectPlan(cardDiv, planTitle, priceInfo) {
            document.querySelectorAll('.plan-card').forEach(el => el.classList.remove('selected'));
            cardDiv.classList.add('selected');
            currentSelectedPlan = planTitle;
            currentEstimatedPrice = priceInfo.replace(/<[^>]*>/g, '');
            const step3 = document.getElementById('step-3-contact');
            if (!step3.classList.contains('active')) {
                step3.classList.add('active');
                setTimeout(() => step3.scrollIntoView({ behavior: 'smooth', block: 'start' }), 200);
            }
        }

        function sendToLine() {
            const name = document.getElementById('user-name').value.trim();
            const phone = document.getElementById('user-phone').value.trim();
            const phoneRegex = /^09\d{8}$/;

            document.getElementById('phone-error').style.display = 'none';
            document.getElementById('user-phone').classList.remove('input-error');

            if (!name) { alert("è«‹è¼¸å…¥è¯çµ¡äººå§“å"); document.getElementById('user-name').focus(); return; }
            if (!phoneRegex.test(phone)) {
                document.getElementById('user-phone').classList.add('input-error');
                document.getElementById('phone-error').style.display = 'block';
                document.getElementById('user-phone').focus();
                return;
            }

            const message = `ä½ å¥½ï¼æˆ‘æƒ³è©¢å•å„ªæƒ åƒ¹ ğŸ’°\n--------------------------\nğŸ“… å…¥ä½ï¼š${formatDate(selectedStart)}\nğŸ“… é€€æˆ¿ï¼š${formatDate(selectedEnd)}\nğŸ¨ é¤¨åˆ¥ï¼š${currentVenueName}\nğŸ›ï¸ æ–¹æ¡ˆï¼š${currentSelectedPlan}\nğŸ’µ é ä¼°ï¼š${currentEstimatedPrice}\n--------------------------\nğŸ‘¤ å§“åï¼š${name}\nğŸ“± é›»è©±ï¼š${phone}\n--------------------------\nè«‹å•æ­¤æ–¹æ¡ˆæ˜¯å¦æœ‰ç©ºæˆ¿æˆ–å„ªæƒ ï¼Ÿè¬è¬ï¼`;

            navigator.clipboard.writeText(message).then(() => {
                if (confirm("âœ… è¨‚æˆ¿è³‡æ–™å·²è¤‡è£½ï¼\n\nè«‹é»æ“Šã€Œç¢ºå®šã€é–‹å•Ÿ LINEï¼Œä¸¦åœ¨å°è©±æ¡†æŒ‰ã€Œè²¼ä¸Šã€(æˆ– Ctrl+V) å‚³é€å³å¯ã€‚")) {
                    window.location.href = LINE_DEEP_LINK;
                    document.getElementById('manual-line-btn').style.display = 'block';
                    document.getElementById('force-line-link').href = LINE_DEEP_LINK;
                }
            }).catch(() => {
                alert("âš ï¸ ç€è¦½å™¨é˜»æ“‹è‡ªå‹•è¤‡è£½ï¼Œè«‹æ‰‹å‹•è¤‡è£½ä»¥ä¸‹è³‡è¨Šï¼š\n\n" + message);
                document.getElementById('manual-line-btn').style.display = 'block';
                document.getElementById('force-line-link').href = LINE_DEEP_LINK;
            });
        }

        function formatDate(d) { return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`; }
        function applyDate(s, e) { fp.setDate([s, e]); selectedStart = new Date(s); selectedEnd = new Date(e); startQuery(); }
        function toggleCalendarVisibility() {
            const wrapper = document.getElementById('calendars-wrapper');
            wrapper.classList.toggle('show');
            if(wrapper.classList.contains('show')) wrapper.scrollIntoView({behavior: "smooth", block: "start"});
        }
    </script>
</body>
</html>