<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>å³æ™‚æˆ¿æ³æŸ¥è©¢ | æºé ‚æ°‘å®¿ (Godin B&B)</title>
<meta name="description" content="æºé ‚æ°‘å®¿ (Godin B&B) ç·šä¸Šæˆ¿æ³æŸ¥è©¢ã€‚è¼¸å…¥æ—¥æœŸèˆ‡äººæ•¸ï¼Œç³»çµ±è‡ªå‹•è©¦ç®—åŒ…æ£Ÿå„ªæƒ åƒ¹æ ¼ï¼Œä¸¦å¯ç›´æ¥é€£çµ LINE é ç´„ã€‚">
<meta name="robots" content="noindex, nofollow">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<link rel="stylesheet" type="text/css" href="https://npmcdn.com/flatpickr/dist/themes/airbnb.css">

<style>
/* ---------------------------------------------------- */
/* --- 1. å…¨å±€è®Šæ•¸ & æ ¸å¿ƒè¨­å®š (Godin System) --- */
/* ---------------------------------------------------- */
:root {
    --primary-color: #3A6A8C;   /* æ²ˆç©©è— */
    --accent-warm: #C69C6D;     /* å¤§åœ°é‡‘ */
    --cta-bg: #B07D62;          /* ç£šç´… */
    
    --bg-light: #F9F7F5;        /* é é¢èƒŒæ™¯ */
    --bg-white: #FFFFFF;        /* å¡ç‰‡èƒŒæ™¯ */
    --text-main: #2C3E50;       
    --text-sub: #5D5D5D;
    
    --line-green: #06C755;
    --nav-height: 70px;
    --footer-bg: #4A3B32;
    --shadow-card: 0 10px 30px rgba(0,0,0,0.06);
    --border-radius: 12px;
    --error-color: #E53E3E;
    --success-color: #38a169;
}

* { box-sizing: border-box; }

body {
    margin: 0; padding: 0;
    font-family: 'Noto Sans TC', sans-serif;
    background-color: var(--bg-light);
    color: var(--text-main);
    line-height: 1.7;
    padding-top: var(--nav-height);
    display: flex; flex-direction: column; min-height: 100vh;
}

a { text-decoration: none; color: inherit; transition: 0.3s; cursor: pointer; }
ul { list-style: none; padding: 0; margin: 0; }
img { max-width: 100%; display: block; }

/* ---------------------------------------------------- */
/* --- 2. å°è¦½åˆ— (Navbar) - Godin æ¨™æº–ç‰ˆ --- */
/* ---------------------------------------------------- */
.navbar {
    position: fixed; top: 0; left: 0; width: 100%;
    height: var(--nav-height);
    background: rgba(255, 255, 255, 0.98);
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    z-index: 1000;
    display: flex; justify-content: center;
}
.nav-container {
    width: 100%; max-width: 1200px;
    display: flex; justify-content: space-between; align-items: center;
    padding: 0 20px;
}
.nav-logo {
    font-size: 22px; font-weight: 700; color: var(--primary-color);
    letter-spacing: 1px; display: flex; align-items: center; gap: 8px;
}
.nav-menu { display: flex; gap: 5px; align-items: center; }
.nav-link {
    display: flex; align-items: center; gap: 6px;
    padding: 10px 15px; font-size: 15px; font-weight: 500;
    color: var(--text-main); border-radius: 6px;
}
.nav-link:hover { color: var(--cta-bg); background-color: #fdf5e6; }
.nav-link.active { color: var(--cta-bg); font-weight: 700; }

/* Dropdown Menu */
.nav-item { position: relative; }
.dropdown-menu {
    position: absolute; top: 100%; left: 0;
    background: white; min-width: 180px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    border-radius: 8px; padding: 10px 0;
    opacity: 0; visibility: hidden; transform: translateY(10px);
    transition: all 0.3s ease; text-align: left;
}
.nav-item:hover .dropdown-menu { opacity: 1; visibility: visible; transform: translateY(0); }
.dropdown-link { display: block; padding: 10px 20px; font-size: 14px; color: var(--text-sub); }
.dropdown-link:hover { background-color: #fdf5e6; color: var(--cta-bg); }

.nav-btn-booking {
    background-color: var(--primary-color); color: white !important;
    padding: 8px 20px; border-radius: 50px; margin-left: 10px;
}
.nav-btn-booking:hover { background-color: #2c5370; }
.menu-toggle { display: none; cursor: pointer; }
.bar { display: block; width: 25px; height: 3px; background: var(--text-main); margin: 5px auto; transition: 0.3s; }

/* ---------------------------------------------------- */
/* --- 3. Hero Header --- */
/* ---------------------------------------------------- */
.hero-header {
    position: relative;
    min-height: 400px;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    text-align: center; color: white;
    background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), 
                url('images/cover-bg.jpg');
    background-size: cover; 
    background-position: center; 
    background-attachment: fixed;
    margin-bottom: 40px;
}
.hero-title {
    font-size: 42px; font-weight: 900; 
    margin: 0 0 10px 0; letter-spacing: 3px;
    text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
}
.hero-subtitle {
    font-size: 20px; font-weight: 300;
    letter-spacing: 4px;
    text-transform: uppercase;
    opacity: 0.9;
}

/* ---------------------------------------------------- */
/* --- 4. æŸ¥è©¢é é¢æ¨£å¼ (Booking Styles) --- */
/* ---------------------------------------------------- */
.container { max-width: 1000px; margin: 0 auto; padding: 0 20px 80px; flex: 1; position: relative; z-index: 10; }

/* æŸ¥è©¢ä¸»å¡ç‰‡ */
.inquiry-box {
    background: var(--bg-white); padding: 40px;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-card);
    margin-top: -60px; /* ä¸Šç§»è¦†è“‹ Hero */
    border-top: 5px solid var(--accent-warm);
}

/* è¡¨å–®ç¶²æ ¼ */
.form-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
.form-group label { display: block; font-size: 15px; color: var(--primary-color); margin-bottom: 8px; font-weight: bold; }
.form-control {
    width: 100%; padding: 12px; border: 1px solid #CBD5E0; border-radius: 8px;
    font-size: 16px; background: #fff; transition: 0.3s; font-family: inherit;
}
.form-control:focus { border-color: var(--accent-warm); outline: none; box-shadow: 0 0 0 3px rgba(198, 156, 109, 0.2); }

/* äººæ•¸é¸æ“‡æŒ‰éˆ• */
.guest-selector { display: flex; gap: 10px; width: 100%; margin-bottom: 5px; }
.guest-btn {
    flex: 1; padding: 12px 5px; background: #F8FAFC; border: 1px solid #E2E8F0;
    border-radius: 8px; cursor: pointer; color: var(--text-sub);
    font-size: 16px; font-weight: 500; transition: 0.2s;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    line-height: 1.3; text-align: center;
}
.guest-btn:hover { background: #fff; border-color: var(--accent-warm); }
.guest-btn.active {
    background-color: var(--accent-warm); color: white;
    border-color: var(--accent-warm);
    box-shadow: 0 4px 10px rgba(198, 156, 109, 0.3);
}
.guest-btn small { font-size: 12px; font-weight: normal; opacity: 0.9; }

/* æŸ¥è©¢æŒ‰éˆ• */
.btn {
    display: inline-flex; align-items: center; justify-content: center; gap: 8px;
    padding: 14px 30px; border-radius: 50px; font-weight: bold; cursor: pointer;
    border: none; font-size: 16px; width: 100%; transition: 0.3s;
}
.btn-search {
    background-color: var(--primary-color); color: white;
    box-shadow: 0 4px 15px rgba(58, 106, 140, 0.3);
}
.btn-search:hover { background-color: #2c5370; transform: translateY(-2px); }

/* è¼‰å…¥ä¸­ç‹€æ…‹ */
.status-loading {
    margin-top: 30px; padding: 20px; background: #EBF8FF;
    color: var(--primary-color); text-align: center; border-radius: 12px; display: none;
}

/* é¤¨åˆ¥çµæœå¡ç‰‡ */
.venue-results { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; display: none; }
.venue-card {
    border: 2px solid #eee; border-radius: 12px; padding: 25px;
    text-align: center; cursor: pointer; transition: 0.3s;
    position: relative; background: #fff;
    display: flex; flex-direction: column; justify-content: space-between;
}
.venue-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
.venue-card.disabled { opacity: 0.6; cursor: not-allowed; background: #f9f9f9; border-color: #eee; }
.venue-card.available { border-color: var(--success-color); background: #F0FFF4; }
.venue-card.available:hover { background: #E6FFFA; }

.venue-name { font-size: 18px; font-weight: bold; color: var(--primary-color); margin-bottom: 5px; }
.venue-status { font-size: 15px; font-weight: bold; margin: 10px 0; }
.status-ok { color: var(--success-color); }
.status-full { color: var(--error-color); }

.venue-btn {
    display: inline-block; font-size: 14px; padding: 8px 20px;
    border-radius: 50px; border: 1px solid; margin-top: 10px; font-weight: bold;
}
.btn-select { background: var(--success-color); color: white; border-color: var(--success-color); }
.btn-full { background: transparent; color: var(--error-color); border-color: var(--error-color); }
.btn-external {
    display: block; width: 100%; text-align: center; padding: 8px 10px;
    margin-top: auto; margin-bottom: 10px; border: 1px solid var(--primary-color);
    color: var(--primary-color); border-radius: 8px; font-size: 13px;
    background: #fff; transition: 0.2s; font-weight: bold;
}
.btn-external:hover { background: #F0F4F8; }

/* æ¨è–¦æª”æœŸ */
.recommendation-area { margin-top: 30px; border-top: 1px dashed #ddd; padding-top: 20px; text-align: left; display: none; }
.rec-title { color: var(--cta-bg); font-weight: bold; margin-bottom: 15px; font-size: 15px; display:flex; gap:8px; align-items:center;}
.suggestion-item {
    display: flex; justify-content: space-between; align-items: center;
    background: #fff; border: 1px solid #e2e2e2; padding: 15px;
    margin-bottom: 10px; border-radius: 8px; cursor: pointer; transition: 0.2s;
}
.suggestion-item:hover { border-color: var(--accent-warm); background-color: #FFFCF5; }
.tag-hot { background: #FFF9F0; color: #975A16; font-size:12px; padding:3px 8px; border-radius:4px; border:1px solid #F6E05E; }
.tag-week { background: #E6FFFA; color: #285E61; font-size:12px; padding:3px 8px; border-radius:4px; }
.sugg-date { font-weight:bold; color: var(--text-main); margin-left:10px;}

/* æ­¥é©Ÿå€åŸŸ */
.step-section { margin-top: 40px; border-top: 2px dashed #eee; padding-top: 40px; display: none; animation: fadeIn 0.5s ease; }
.step-section.active { display: block; }
.step-title {
    font-size: 20px; font-weight: 700; margin-bottom: 10px;
    color: var(--primary-color); border-left: 5px solid var(--accent-warm); padding-left: 15px;
}
.step-subtitle { font-size: 15px; color: var(--cta-bg); margin-bottom: 20px; padding-left: 20px; font-weight: 500; }

/* æ–¹æ¡ˆå¡ç‰‡ */
.plan-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
.plan-card {
    border: 2px solid #eee; border-radius: 12px; padding: 25px;
    cursor: pointer; transition: 0.2s; position: relative; background: #fff;
}
.plan-card:hover { border-color: #ccc; transform: translateY(-2px); }
.plan-card.selected {
    border-color: var(--accent-warm); background-color: #FFFCF5;
    box-shadow: 0 5px 15px rgba(198, 156, 109, 0.2);
}
.plan-card h4 { margin: 0 0 8px 0; font-size: 18px; color: var(--primary-color); }
.plan-price { font-size: 18px; color: var(--accent-warm); font-weight: bold; margin-bottom: 10px; }
.plan-price.event-price { color: var(--error-color); }
.plan-desc { font-size: 14px; color: var(--text-sub); margin: 0; line-height: 1.6; border-top: 1px solid #eee; padding-top: 10px; margin-top: 10px; }
.plan-capacity {
    position: absolute; top: 20px; right: 20px; background: #EDF2F7;
    padding: 4px 10px; border-radius: 4px; font-size: 12px; font-weight: bold; color: var(--text-sub);
}
.plan-card.selected .plan-capacity { background: var(--accent-warm); color: white; }

/* è¯çµ¡è¡¨å–® */
.contact-form {
    background: #F8FAFC; padding: 30px; border-radius: 12px;
    border: 1px solid #E2E8F0; margin-top: 20px;
}
.btn-line {
    background-color: var(--line-green); color: white;
    font-size: 18px; padding: 15px; width: 100%;
    box-shadow: 0 4px 15px rgba(6, 199, 85, 0.3);
}
.btn-line:hover { background-color: #05b64d; transform: translateY(-2px); }
.input-error { border-color: var(--error-color) !important; background-color: #FFF5F5 !important; }
.error-msg { color: var(--error-color); font-size: 13px; display: none; margin-top: 5px; }

/* æ—¥æ›† */
.calendar-toggle-btn {
    display: flex; align-items: center; gap: 8px; margin: 40px auto 20px;
    background: white; border: 1px solid var(--accent-warm);
    padding: 10px 25px; border-radius: 50px; cursor: pointer;
    color: var(--accent-warm); font-weight: bold; transition: 0.3s;
}
.calendar-toggle-btn:hover { background: var(--accent-warm); color: white; }

.calendars-area { display: none; grid-template-columns: 1fr 1fr; gap: 30px; }
.calendars-area.show { display: grid; animation: fadeIn 0.5s ease; }
.calendar-card {
    background: #fff; padding: 20px; border-radius: 12px;
    box-shadow: var(--shadow-card); border-top: 4px solid var(--primary-color);
}
.calendar-card h3 { margin-top:0; color:var(--primary-color); font-size:18px; display:flex; align-items:center; justify-content:space-between; }
.calendar-container {
    position: relative; padding-bottom: 75%; height: 0; overflow: hidden;
    border-radius: 8px; background: #f9f9f9; border:1px solid #eee;
}
.calendar-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

/* ---------------------------------------------------- */
/* --- 5. Footer (å®Œæ•´é‚„åŸç‰ˆ) --- */
/* ---------------------------------------------------- */
footer { background-color: var(--footer-bg); color: #d7ccc8; padding: 60px 20px 20px; margin-top: auto;}
.footer-grid {
    max-width: 1100px; margin: 0 auto;
    display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 40px;
}
.footer-title {
    color: white; font-size: 19px; font-weight: 600;
    border-bottom: 2px solid var(--cta-bg); padding-bottom: 10px; margin-bottom: 20px; display: inline-block;
}
.footer-link {
    display: flex; align-items: center; gap: 10px; color: #d7ccc8;
    margin-bottom: 12px; transition: 0.3s;
}
.footer-link:hover { color: var(--cta-bg); transform: translateX(5px); }

/* Footer Tags */
.keyword-cloud { display: flex; flex-wrap: wrap; gap: 8px; }
.seo-tag {
    background: rgba(255,255,255,0.1); color: #d7ccc8; font-size: 13px;
    padding: 4px 10px; border-radius: 4px; border: 1px solid rgba(255,255,255,0.15);
    transition: 0.3s; cursor: default;
}
.seo-tag:hover { background: var(--cta-bg); color: white; border-color: var(--cta-bg); }

/* RWD */
@media (max-width: 768px) {
    .menu-toggle { display: block; }
    .nav-menu {
        position: fixed; top: 0; right: -100%; width: 80%; height: 100vh;
        background: white; flex-direction: column; padding-top: 80px;
        transition: 0.4s; box-shadow: -5px 0 15px rgba(0,0,0,0.1);
        align-items: flex-start;
    }
    .nav-menu.active { right: 0; }
    .nav-link { width: 100%; padding: 15px 30px; border-bottom: 1px solid #eee; }
    .dropdown-menu { position: static; box-shadow: none; display: none; opacity: 1; visibility: visible; transform: none; padding-left: 20px; background: #f9f9f9; }
    .nav-item.active .dropdown-menu { display: block; }
    
    .hero-title { font-size: 32px; }
    .hero-subtitle { font-size: 16px; letter-spacing: 2px; }
    
    .venue-results { grid-template-columns: 1fr; }
    .calendars-area { grid-template-columns: 1fr; }
    .guest-selector { flex-direction: column; }
}

/* Animation */
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.fade-in { animation: fadeIn 0.8s ease-out forwards; opacity: 0; } 
.fade-in.visible { opacity: 1; }
</style>
</head>
<body>

    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fa-solid fa-house-chimney" style="color:var(--cta-bg);"></i>
                æºé ‚æ°‘å®¿
            </div>
            
            <div class="menu-toggle" id="mobile-menu-btn">
                <span class="bar"></span><span class="bar"></span><span class="bar"></span>
            </div>
            
            <ul class="nav-menu" id="nav-menu">
                <li class="nav-item"><a href="index.html" class="nav-link"><i class="fa-solid fa-house"></i> é¦–é </a></li>
                <li class="nav-item"><a href="rooms.html" class="nav-link"><i class="fa-solid fa-bed"></i> æˆ¿å‹ä»‹ç´¹</a></li>
                
                <li class="nav-item dropdown">
                    <a href="agreement.html" class="nav-link dropdown-toggle">
                        <i class="fa-solid fa-file-signature"></i> å…¥ä½é ˆçŸ¥ <i class="fa-solid fa-angle-down"></i>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="signature.html" class="dropdown-link"><i class="fa-solid fa-pen-nib"></i> ç·šä¸Šç°½ç½²</a></li>
                    </ul>
                </li>
                
                <li class="nav-item"><a href="traffic.html" class="nav-link"><i class="fa-solid fa-car"></i> äº¤é€šåœè»Š</a></li>
                
                <li class="nav-item dropdown">
                    <a href="travel.html" class="nav-link dropdown-toggle">
                        <i class="fa-solid fa-map-location-dot"></i> æ—…éŠè¡Œç¨‹ <i class="fa-solid fa-angle-down"></i>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="attractions.html" class="dropdown-link">å‘¨é‚Šæ™¯é»</a></li>
                        <li><a href="food.html" class="dropdown-link">é¹½åŸ•ç¾é£Ÿåœ°åœ–</a></li>
                    </ul>
                </li>

                <li class="nav-item">
                    <a href="check.html" class="nav-link nav-btn-booking active">
                        <i class="fa-solid fa-calendar-check"></i> æŸ¥è©¢ç©ºæˆ¿
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <header class="hero-header">
        <h1 class="hero-title">å³æ™‚æˆ¿æ³æŸ¥è©¢</h1>
        <div class="hero-subtitle">CHECK AVAILABILITY</div>
    </header>

    <div class="container">
        <div class="inquiry-box fade-in">
            
            <div id="step-1-query">
                <h2 style="font-size:22px; margin-bottom:25px; color:var(--primary-color); border-bottom:1px solid #eee; padding-bottom:15px;">
                    <i class="fa-solid fa-calendar-days" style="color:var(--accent-warm)"></i> 1. æŸ¥è©¢æª”æœŸ
                </h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>1. é è¨ˆäººæ•¸ (è«‹é¸æ“‡å€é–“)</label>
                        <div class="guest-selector">
                            <div class="guest-btn active" onclick="selectGuestRange('range1', this)">
                                12äººå…§
                                <small>ä½ å¥½å“‡ / æºé ‚</small>
                            </div>
                            <div class="guest-btn" onclick="selectGuestRange('range2', this)">
                                13-26äºº
                                <small>ä½ å¥½å“‡å¯“æ‰€</small>
                            </div>
                            <div class="guest-btn" onclick="selectGuestRange('range3', this)">
                                26-38äºº
                                <small>é›™é¤¨åŒ…æ£Ÿ</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>2. å…¥ä½ - é€€æˆ¿æ—¥æœŸ</label>
                        <input type="text" id="date-range" class="form-control" placeholder="é»æ“Šé¸æ“‡æ—¥æœŸç¯„åœ..." readonly>
                    </div>
                    
                    <button class="btn btn-search" onclick="startQuery()">
                        <i class="fa-solid fa-magnifying-glass"></i> æŸ¥è©¢ç©ºæˆ¿ç‹€æ³
                    </button>
                </div>
                
                <div id="loading-box" class="status-loading">
                    <i class="fa-solid fa-spinner fa-spin"></i> æ­£åœ¨é€£ç·šç¢ºèªå³æ™‚æª”æœŸ...
                </div>

                <div id="venue-results" class="venue-results"></div>

                <div id="recommendation-area" class="recommendation-area"></div>
            </div>

            <div id="step-2-plan" class="step-section">
                <div class="step-title">2. é¸æ“‡åŒ…æ£Ÿæˆ¿å‹æ–¹æ¡ˆ</div>
                <div id="step-2-subtitle" class="step-subtitle"></div>
                <div id="plan-container" class="plan-options"></div>
                <p style="text-align:right; font-size:13px; color:#999; margin-top:10px;">* åƒ¹æ ¼åƒ…ä¾›åƒè€ƒï¼Œå¯¦éš›åƒ¹æ ¼ä»¥ç®¡å®¶å ±åƒ¹ç‚ºæº–ã€‚</p>
            </div>

            <div id="step-3-contact" class="step-section">
                <div class="step-title">3. å¡«å¯«è¯çµ¡è³‡æ–™ï¼Œç²å–å„ªæƒ å ±åƒ¹</div>
                <div class="contact-form">
                    <div class="form-group" style="margin-bottom:15px;">
                        <label>è¯çµ¡äººå§“å</label>
                        <input type="text" id="user-name" class="form-control" placeholder="è«‹è¼¸å…¥æ‚¨çš„ç¨±å‘¼">
                    </div>
                    <div class="form-group" style="margin-bottom:25px;">
                        <label>æ‰‹æ©Ÿè™Ÿç¢¼</label>
                        <input type="tel" id="user-phone" class="form-control" placeholder="09xxxxxxxx" maxlength="10">
                        <div id="phone-error" class="error-msg">è«‹è¼¸å…¥æ­£ç¢ºçš„ 10 ç¢¼æ‰‹æ©Ÿè™Ÿç¢¼</div>
                    </div>
                    
                    <button id="btn-submit" class="btn btn-line" onclick="sendToLine()">
                        <i class="fa-brands fa-line" style="font-size:24px;"></i> å‚³é€çµ¦ç®¡å®¶è©¢å•å„ªæƒ 
                    </button>
                    
                    <div id="manual-line-btn" style="display:none; margin-top:15px; text-align:center;">
                        <a id="force-line-link" href="#" class="btn" style="background:#06C755; color:white;">
                            <i class="fa-brands fa-line"></i> é–‹å•Ÿ LINE App
                        </a>
                    </div>
                    <p style="text-align:center; font-size:13px; color:#888; margin-top:15px;">ğŸ’¡ ç³»çµ±å·²è‡ªå‹•è¤‡è£½è¨‚æˆ¿è³‡è¨Šï¼Œé–‹å•Ÿ LINE å¾Œè«‹åœ¨å°è©±æ¡†ã€Œé•·æŒ‰è²¼ä¸Šã€å³å¯ã€‚</p>
                </div>
            </div>

        </div>

        <button class="calendar-toggle-btn" onclick="toggleCalendarVisibility()">
            <i class="fa-solid fa-calendar-days"></i> æŸ¥çœ‹è©³ç´°æ—¥æ›†
        </button>

        <div id="calendars-wrapper" class="calendars-area fade-in">
            <div class="calendar-card" id="cal-hello">
                <h3>ä½ å¥½å“‡å¯“æ‰€ <span style="font-size:12px; background:#eee; padding:2px 8px; border-radius:4px; color:#555;">ä¸»é¤¨</span></h3>
                <div class="calendar-container"><iframe src="https://calendar.google.com/calendar/embed?src=a77a451f0a645261b0202f6faf810082df31f92d20fe20c19cbb10945d9714f4%40group.calendar.google.com&ctz=Asia%2FTaipei" scrolling="no"></iframe></div>
            </div>
            <div class="calendar-card" id="cal-gouding">
                <h3>æºé ‚æ°‘å®¿ <span style="font-size:12px; background:var(--accent-warm); padding:2px 8px; border-radius:4px; color:#fff;">äºŒé¤¨</span></h3>
                <div class="calendar-container"><iframe src="https://calendar.google.com/calendar/embed?src=56feb65c62285b41fe4c97af783991d9710832f223bf2a85919bb60c04be3603%40group.calendar.google.com&ctz=Asia%2FTaipei&color=%23795548" scrolling="no"></iframe></div>
            </div>
        </div>
        
    </div>

    <footer>
        <div class="footer-grid">
            <div>
                <div class="footer-title">é—œæ–¼ æºé ‚æ°‘å®¿</div>
                <p style="line-height: 1.8; text-align: justify; color: #d7ccc8;">
                    æºé ‚æ°‘å®¿ (Godin B&B) ä½æ–¼é«˜é›„å¸‚é¹½åŸ•å€å¤§å…¬è·¯å··å¼„å…§ï¼Œè‡´åŠ›æ–¼æä¾›åƒå®¶ä¸€æ¨£æº«æš–çš„åŒ…æ£Ÿä½å®¿é«”é©—ã€‚æˆ‘å€‘çµåˆäº†è€å±‹çš„å¾©å¤é¢¨æƒ…èˆ‡ç¾ä»£åŒ–çš„ä¾¿åˆ©è¨­æ–½ï¼Œæ˜¯æ‚¨æ¢ç´¢é«˜é›„æ¸¯ç£çš„æœ€ä½³è½è…³è™•ã€‚
                </p>
            </div>
            <div>
                <div class="footer-title">è¯çµ¡æˆ‘å€‘</div>
                <a href="https://goo.gl/maps/placeholder" target="_blank" class="footer-link">
                    <i class="fa-solid fa-location-dot"></i> é«˜é›„å¸‚é¹½åŸ•å€å¤§å…¬è·¯70å··6-2è™Ÿ
                </a>
                <a href="tel:0932828922" class="footer-link">
                    <i class="fa-solid fa-phone"></i> 0932-828-922
                </a>
                <a href="javascript:void(0)" onclick="sendToLine()" class="footer-link">
                    <i class="fa-brands fa-line"></i> LINE å®˜æ–¹å¸³è™Ÿè¯ç¹«
                </a>
                <div style="margin-top: 15px; font-size: 14px; color: #a1887f;">
                    <i class="fa-solid fa-clock"></i> å®¢æœæ™‚é–“: 09:00 - 21:00
                </div>
            </div>
            
            <div>
                <div class="footer-title">ç†±é–€é—œéµå­—</div>
                <div class="keyword-cloud">
                    <span class="seo-tag">é«˜é›„åŒ…æ£Ÿ</span>
                    <span class="seo-tag">é«˜é›„åŒ…æ£Ÿæ°‘å®¿</span>
                    <span class="seo-tag">é«˜é›„10äººåŒ…æ£Ÿ</span>
                    <span class="seo-tag">é¹½åŸ•å€æ°‘å®¿</span>
                    <span class="seo-tag">é§äºŒä½å®¿</span>
                    <span class="seo-tag">é«˜é›„éº»å°‡æ°‘å®¿</span>
                    <span class="seo-tag">è¦ªå­å‹å–„åŒ…æ£Ÿ</span>
                    <span class="seo-tag">æ·é‹ç«™ä½å®¿</span>
                </div>
            </div>
        </div>
        <div style="text-align: center; border-top: 1px solid rgba(255,255,255,0.1); margin-top: 50px; padding-top: 20px; font-size: 13px; color: #a1887f;">
            Â© 2025 Godin B&B æºé ‚æ°‘å®¿. All Rights Reserved.
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/zh-tw.js"></script>
    
    <script>
        // æ ¸å¿ƒè¨­å®š
        const GAS_APP_URL = "https://script.google.com/macros/s/AKfycbxsFEJ9ubWMY9Y6xqBZ-3-KgSrYQnC9D3zwuKUL66HvKJdN5S1HTNeahhWlV6hcixbx0A/exec";
        const LINE_DEEP_LINK = "line://ti/p/@575tprig"; 

        let selectedStart = null;
        let selectedEnd = null;
        let selectedGuestRange = 'range1'; 
        let currentSelectedPlan = null;
        let currentEstimatedPrice = null;
        let currentVenueName = null;
        
        const WEEKDAYS = ["é€±æ—¥", "é€±ä¸€", "é€±äºŒ", "é€±ä¸‰", "é€±å››", "é€±äº”", "é€±å…­"];
        function getWeekday(dateStr) {
            const d = new Date(dateStr);
            return WEEKDAYS[d.getDay()];
        }

        // ç‰¹æ®Šç¯€æ—¥èˆ‡é€£å‡è¨­å®š (Mock Data)
        const SPECIAL_EVENTS = ["2025-03-29", "2025-03-30", "2025-04-04", "2025-04-05", "2025-12-31"];
        const NATIONAL_HOLIDAYS = ["2025-01-01", "2025-02-28", "2025-04-04", "2025-04-05"];

        const ROOM_PLANS = {
            'hello': [
                { title: "3æˆ¿åŒ…æ£Ÿ (8äºº)", price_weekday: 16000, price_weekend: 20000, capacity: "8äºº", detail: "é…ç½®ï¼š3æˆ¿ (2/2/4)" },
                { title: "4æˆ¿åŒ…æ£Ÿ (14äºº)", price_weekday: 20000, price_weekend: 24000, capacity: "14äºº", detail: "é…ç½®ï¼š4æˆ¿ (2/2/4/6)" },
                { title: "5æˆ¿åŒ…æ£Ÿ (16äºº)", price_weekday: 22000, price_weekend: 26000, capacity: "16äºº", detail: "é…ç½®ï¼š5æˆ¿ (2/2/2/4/6)" },
                { title: "5+1æˆ¿åŒ…æ£Ÿ (22äºº)", price_weekday: 26000, price_weekend: 30000, capacity: "22äºº", detail: "é…ç½®ï¼š5+1æˆ¿ (2/2/2/4/6/6)" },
                { title: "5+1æˆ¿+åŠ åºŠ (26äºº)", price_weekday: 30000, price_weekend: 36000, capacity: "26äºº", detail: "é…ç½®ï¼š2/2/2/4/6+2/6+2" }
            ],
            'gouding': [
                { title: "3æˆ¿åŒ…æ£Ÿ (10äºº)", price_weekday: 10000, price_weekend: 14000, capacity: "10äºº", detail: "é…ç½®ï¼š3æˆ¿ (2/4/4)" },
                { title: "4æˆ¿åŒ…æ£Ÿ (12äºº)", price_weekday: 12000, price_weekend: 16000, capacity: "12äºº", detail: "é…ç½®ï¼š4æˆ¿ (2/4/4/2)" }
            ],
            'double': [
                { title: "ä½ å¥½å“‡+æºé ‚æ°‘å®¿ é›™åŒ…æ£Ÿ (27-38äºº)", price_weekday: 42000, price_weekend: 50000, capacity: "38äºº", detail: "åŒ…å«ï¼šä½ å¥½å“‡(26äºº) + æºé ‚(12äºº)" }
            ]
        };

        // åˆå§‹åŒ–æ—¥æœŸé¸æ“‡å™¨
        const fp = flatpickr("#date-range", {
            mode: "range", locale: "zh_tw", dateFormat: "Y-m-d", minDate: "today",
            onOpen: function() { resetSteps(); },
            onChange: function(dates) { resetSteps(); },
            onClose: function(dates) { 
                if (dates.length === 2) { 
                    selectedStart = dates[0]; 
                    selectedEnd = dates[1]; 
                } 
            }
        });

        // åˆå§‹åŒ–èˆ‡é¸å–®é‚è¼¯
        document.addEventListener('DOMContentLoaded', () => {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
            }, { threshold: 0.1 });
            document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

            const mobileMenu = document.getElementById('mobile-menu-btn');
            const navMenu = document.getElementById('nav-menu');
            const dropdownToggles = document.querySelectorAll('.dropdown-toggle');

            mobileMenu.addEventListener('click', () => {
                mobileMenu.classList.toggle('active');
                navMenu.classList.toggle('active');
            });

            dropdownToggles.forEach(toggle => {
                toggle.addEventListener('click', (e) => {
                    if (window.innerWidth <= 768) {
                        e.preventDefault();
                        const parent = toggle.parentElement;
                        parent.classList.toggle('active');
                    }
                });
            });

            document.addEventListener('click', (e) => {
                if (!navMenu.contains(e.target) && !mobileMenu.contains(e.target)) {
                    navMenu.classList.remove('active');
                    mobileMenu.classList.remove('active');
                }
            });
        });

        function selectGuestRange(range, btn) {
            selectedGuestRange = range;
            document.querySelectorAll('.guest-btn').forEach(el => el.classList.remove('active'));
            btn.classList.add('active');
            resetSteps();
        }

        function startQuery() {
            resetSteps();
            if (!selectedStart || !selectedEnd) { alert("è«‹å…ˆé¸æ“‡å…¥ä½èˆ‡é€€æˆ¿æ—¥æœŸ"); fp.open(); return; }
            document.getElementById('loading-box').style.display = 'block';
            const startStr = formatDate(selectedStart);
            const endStr = formatDate(selectedEnd);
            const url = `${GAS_APP_URL}?start=${startStr}&end=${endStr}&venue=all`;

            fetch(url).then(r => r.json()).then(data => {
                document.getElementById('loading-box').style.display = 'none';
                renderVenueCards(data.status);
                
                // æ¨è–¦é‚è¼¯
                let needRec = false;
                if (selectedGuestRange === 'range1' && !data.status.hello.available && !data.status.gouding.available) needRec = true;
                if (selectedGuestRange === 'range2' && !data.status.hello.available) needRec = true;
                if (selectedGuestRange === 'range3' && (!data.status.hello.available || !data.status.gouding.available)) needRec = true;
                if (needRec) renderRecommendations(data.suggestions);
            }).catch(e => {
                console.error(e);
                document.getElementById('loading-box').style.display = 'none';
                alert("é€£ç·šå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–ç›´æ¥è¯ç¹«ç®¡å®¶ã€‚");
            });
        }

        function renderVenueCards(status) {
            const container = document.getElementById('venue-results');
            container.innerHTML = '';
            container.style.display = 'grid';
            let cardsToShow = [];

            if (selectedGuestRange === 'range3') {
                const isDoubleAvailable = status.hello.available && status.gouding.available;
                cardsToShow.push({ key: 'double', name: 'ä½ å¥½å“‡+æºé ‚æ°‘å®¿ é›™åŒ…æ£Ÿ', available: isDoubleAvailable, desc: 'é©åˆ 27-38 äººå¤§åœ˜é«”' });
            } else if (selectedGuestRange === 'range2') {
                cardsToShow.push({ key: 'hello', name: 'ä½ å¥½å“‡å¯“æ‰€ (ä¸»é¤¨)', available: status.hello.available, desc: 'é©åˆ 13-26 äºº' });
            } else {
                cardsToShow.push({ key: 'hello', name: 'ä½ å¥½å“‡å¯“æ‰€ (ä¸»é¤¨)', available: status.hello.available, desc: 'é©åˆ 6-26 äºº' });
                cardsToShow.push({ key: 'gouding', name: 'æºé ‚æ°‘å®¿ (äºŒé¤¨)', available: status.gouding.available, desc: 'é©åˆ 6-12 äºº' });
            }

            cardsToShow.forEach(card => {
                const div = document.createElement('div');
                const statusClass = card.available ? 'available' : 'disabled';
                const statusText = card.available ? '<span class="status-ok"><i class="fa-solid fa-circle-check"></i> å¯é è¨‚</span>' : '<span class="status-full">âŒ å·²æ»¿æˆ¿</span>';
                const btnClass = card.available ? 'btn-select' : 'btn-full';
                const btnText = card.available ? 'é¸æ“‡æ­¤é¤¨' : 'ä¸å¯é è¨‚';
                
                let extraBtn = '';
                // æºé ‚å°ˆå±¬å¤–é€£æŒ‰éˆ•ç§»é™¤ï¼Œå› ç‚ºé€™å°±æ˜¯æºé ‚ç¶²ç«™

                div.className = `venue-card ${statusClass}`;
                div.innerHTML = `
                    <div>
                        <div class="venue-name">${card.name}</div>
                        <div style="font-size:14px; color:#666; margin-bottom:5px;">${card.desc}</div>
                        <div class="venue-status">${statusText}</div>
                    </div>
                    <div>
                        <div class="venue-btn ${btnClass}">${btnText}</div>
                    </div>
                `;
                
                if (card.available) {
                    div.onclick = () => selectVenue(card.key, card.name);
                }
                container.appendChild(div);
            });
        }

        function selectVenue(key, name) {
            currentVenueName = name;
            renderRoomOptions(key);
        }

        // æ¨è–¦æ¼”ç®—æ³•
        function processBestRecommendations(rawSuggestions) {
            if (!rawSuggestions || rawSuggestions.length === 0) return [];
            let best5 = [];
            const partial = rawSuggestions.find(s => s.tag === 'part');
            if (partial) best5.push(partial);
            const days = rawSuggestions.filter(s => s.tag !== 'part' && s.tag !== 'week').slice(0, 2);
            best5 = best5.concat(days);
            const weeks = rawSuggestions.filter(s => s.tag === 'week').slice(0, 2);
            best5 = best5.concat(weeks);
            if (best5.length < 5) {
                const others = rawSuggestions.filter(s => !best5.includes(s));
                best5 = best5.concat(others.slice(0, 5 - best5.length));
            }
            return best5;
        }

        function renderRecommendations(suggestions) {
            const area = document.getElementById('recommendation-area');
            area.innerHTML = '';
            const finalSuggestions = processBestRecommendations(suggestions);
            if (finalSuggestions.length === 0) return;

            area.style.display = 'block';
            let html = `<div class="rec-title"><i class="fa-solid fa-bell"></i> å¾ˆæŠ±æ­‰ï¼Œæ‚¨é¸æ“‡çš„æ—¥æœŸå·²æ»¿ã€‚ç‚ºæ‚¨æ¨è–¦æœ€ä½³æª”æœŸï¼š</div>`;
            
            finalSuggestions.forEach(s => {
                let tagClass = 'tag-hot';
                let icon = 'fa-calendar-day';
                let label = s.label || 'æ¨è–¦æª”æœŸ';
                let subLabel = '';

                const sDate = new Date(s.start);
                const diffTime = sDate - selectedStart;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (s.tag === 'part') {
                    tagClass = 'tag-week'; 
                    icon = 'fa-scissors'; 
                    label = 'ç¸®çŸ­å¤©æ•¸';
                } else if (Math.abs(diffDays) >= 7) {
                    tagClass = 'tag-week';
                    const weeks = Math.round(diffDays / 7);
                    const direction = weeks > 0 ? "å¾€å¾Œ" : "æå‰";
                    label = `${direction} ${Math.abs(weeks)} é€±`;
                    const startW = getWeekday(s.start);
                    const endW = getWeekday(s.end);
                    subLabel = `(${startW} - ${endW})`;
                } else {
                    const direction = diffDays > 0 ? "å¾€å¾Œ" : "æå‰";
                    label = `${direction} ${Math.abs(diffDays)} å¤©`;
                }
                
                html += `<div class="suggestion-item" onclick="applyDate('${s.start}', '${s.end}')">`;
                html += `  <div style="display:flex; align-items:center;">`;
                html += `    <span class="${tagClass}"><i class="fa-solid ${icon}"></i> ${label}</span>`;
                html += `    <span class="sugg-date">${s.start} ~ ${s.end} ${subLabel}</span>`;
                html += `  </div>`;
                html += `  <span style="font-size:13px; color:var(--accent-warm); font-weight:bold;">é¸æ“‡ <i class="fa-solid fa-angle-right"></i></span></div>`;
            });
            area.innerHTML = html;
        }

        function resetSteps() {
            document.getElementById('step-2-plan').classList.remove('active');
            document.getElementById('step-3-contact').classList.remove('active');
            document.getElementById('venue-results').style.display = 'none';
            document.getElementById('recommendation-area').style.display = 'none';
            currentSelectedPlan = null;
        }

        function isWeekendOrHoliday(date) {
            const dateStr = formatDate(date);
            if (NATIONAL_HOLIDAYS.includes(dateStr)) return true;
            const day = date.getDay();
            if (day === 5 || day === 6) return true; // Fri, Sat
            return false;
        }

        function isSpecialEvent(date) {
            return SPECIAL_EVENTS.includes(formatDate(date));
        }

        function calculateTotalPrice(plan, start, end, venueKey) {
            let total = 0;
            let current = new Date(start);
            let endD = new Date(end);
            let weekdayCount = 0;
            let holidayCount = 0;
            let hasSpecialEvent = false;

            let checkDate = new Date(start);
            while (checkDate < endD) {
                if (isSpecialEvent(checkDate)) {
                    hasSpecialEvent = true;
                    break;
                }
                checkDate.setDate(checkDate.getDate() + 1);
            }

            if (hasSpecialEvent) {
                let eventPrice = 0;
                if (venueKey === 'hello') eventPrice = 34800;
                else if (venueKey === 'gouding') eventPrice = 18400;
                else if (venueKey === 'double') eventPrice = 53200; 

                return { 
                    totalPrice: eventPrice.toLocaleString(), 
                    desc: "ğŸ”¥ é«˜é›„é‡å¤§æ´»å‹•ãƒ»åŸåƒ¹æª”æœŸ",
                    isEvent: true
                };
            }

            while (current < endD) {
                if (isWeekendOrHoliday(current)) { total += plan.price_weekend; holidayCount++; } 
                else { total += plan.price_weekday; weekdayCount++; }
                current.setDate(current.getDate() + 1);
            }
            
            let descParts = [];
            if (weekdayCount > 0) descParts.push(`${weekdayCount}å¹³æ—¥`);
            if (holidayCount > 0) descParts.push(`${holidayCount}å‡æ—¥`);
            return { totalPrice: total.toLocaleString(), desc: descParts.join('+'), isEvent: false };
        }

        function renderRoomOptions(venueKey) {
            const container = document.getElementById('plan-container');
            container.innerHTML = '';
            const plans = ROOM_PLANS[venueKey] || [];
            const daysDiff = Math.round((selectedEnd - selectedStart)/(1000*60*60*24));
            document.getElementById('step-2-subtitle').innerText = `å·²é¸æ“‡ï¼š${formatDate(selectedStart)} è‡³ ${formatDate(selectedEnd)} (å…± ${daysDiff} æ™š) - ${currentVenueName}`;

            plans.forEach((plan) => {
                const calc = calculateTotalPrice(plan, selectedStart, selectedEnd, venueKey);
                const totalStr = `$${calc.totalPrice}`;
                const detailStr = `(${calc.desc})`;
                const priceClass = calc.isEvent ? 'plan-price event-price' : 'plan-price';

                const div = document.createElement('div');
                div.className = 'plan-card';
                div.innerHTML = `
                    <span class="plan-capacity">${plan.capacity}</span>
                    <h4>${plan.title}</h4>
                    <div class="${priceClass}">é ä¼°ç¸½åƒ¹ ${totalStr} <span style="font-size:13px;font-weight:normal;color:#666;">${detailStr}</span></div>
                    <p class="plan-desc">${plan.detail}</p>
                `;
                div.onclick = () => selectPlan(div, plan.title, totalStr + " " + detailStr);
                container.appendChild(div);
            });
            
            const section = document.getElementById('step-2-plan');
            section.classList.add('active');
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function selectPlan(cardDiv, planTitle, priceInfo) {
            document.querySelectorAll('.plan-card').forEach(el => el.classList.remove('selected'));
            cardDiv.classList.add('selected');
            currentSelectedPlan = planTitle;
            currentEstimatedPrice = priceInfo.replace(/<[^>]*>/g, '');
            const step3 = document.getElementById('step-3-contact');
            if (!step3.classList.contains('active')) {
                step3.classList.add('active');
                setTimeout(() => step3.scrollIntoView({ behavior: 'smooth', block: 'start' }), 200);
            }
        }

        function sendToLine() {
            const name = document.getElementById('user-name').value.trim();
            const phone = document.getElementById('user-phone').value.trim();
            const phoneRegex = /^09\d{8}$/;

            document.getElementById('phone-error').style.display = 'none';
            document.getElementById('user-phone').classList.remove('input-error');

            if (!name) { alert("è«‹è¼¸å…¥è¯çµ¡äººå§“å"); document.getElementById('user-name').focus(); return; }
            if (!phoneRegex.test(phone)) {
                document.getElementById('user-phone').classList.add('input-error');
                document.getElementById('phone-error').style.display = 'block';
                document.getElementById('user-phone').focus();
                return;
            }

            const message = `ä½ å¥½ï¼æˆ‘æƒ³è©¢å•å„ªæƒ åƒ¹ ğŸ’°\n--------------------------\nğŸ“… å…¥ä½ï¼š${formatDate(selectedStart)}\nğŸ“… é€€æˆ¿ï¼š${formatDate(selectedEnd)}\nğŸ¨ é¤¨åˆ¥ï¼š${currentVenueName}\nğŸ›ï¸ æ–¹æ¡ˆï¼š${currentSelectedPlan}\nğŸ’µ é ä¼°ï¼š${currentEstimatedPrice}\n--------------------------\nğŸ‘¤ å§“åï¼š${name}\nğŸ“± é›»è©±ï¼š${phone}\n--------------------------\nè«‹å•æ­¤æ–¹æ¡ˆæ˜¯å¦æœ‰ç©ºæˆ¿æˆ–å„ªæƒ ï¼Ÿè¬è¬ï¼`;

            navigator.clipboard.writeText(message).then(() => {
                if (confirm("âœ… è¨‚æˆ¿è³‡æ–™å·²è¤‡è£½ï¼\n\nè«‹é»æ“Šã€Œç¢ºå®šã€é–‹å•Ÿ LINEï¼Œä¸¦åœ¨å°è©±æ¡†æŒ‰ã€Œè²¼ä¸Šã€(æˆ– Ctrl+V) å‚³é€å³å¯ã€‚")) {
                    window.location.href = LINE_DEEP_LINK;
                    document.getElementById('manual-line-btn').style.display = 'block';
                    document.getElementById('force-line-link').href = LINE_DEEP_LINK;
                }
            }).catch(() => {
                alert("âš ï¸ ç€è¦½å™¨é˜»æ“‹è‡ªå‹•è¤‡è£½ï¼Œè«‹æ‰‹å‹•è¤‡è£½ä»¥ä¸‹è³‡è¨Šï¼š\n\n" + message);
                document.getElementById('manual-line-btn').style.display = 'block';
                document.getElementById('force-line-link').href = LINE_DEEP_LINK;
            });
        }

        function formatDate(d) { return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`; }
        function applyDate(s, e) { fp.setDate([s, e]); selectedStart = new Date(s); selectedEnd = new Date(e); startQuery(); }
        function toggleCalendarVisibility() {
            const wrapper = document.getElementById('calendars-wrapper');
            wrapper.classList.toggle('show');
            if(wrapper.classList.contains('show')) wrapper.scrollIntoView({behavior: "smooth", block: "start"});
        }
    </script>
</body>
</html>